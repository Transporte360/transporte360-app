{% extends "layouts/base.html" %}

{% block content %}

  <div class="card card-pad">
    <div class="row" style="justify-content:space-between; align-items:flex-end; gap:10px">
      <div>
        <div class="h2">Nuevo viaje</div>
        <div class="tiny">Registro b√°sico (fecha, origen, destino, km y peso). El resto lo a√±adimos despu√©s.</div>
      </div>
    </div>

    {% if error %}
      <div class="alert" style="margin-top:14px">
        <span>‚ö†Ô∏è</span>
        <div>
          <div style="font-weight:900">Error</div>
          <div class="tiny" style="color:#7f1d1d; opacity:.85">{{ error }}</div>
        </div>
      </div>
    {% endif %}

    <form method="post" class="grid g3" style="margin-top:14px">

      <div class="field">
        <div class="label">üìÖ Fecha</div>
        <input class="input" type="date" name="fecha" required style="padding-left:12px">
      </div>

      <div class="field">
        <div class="label">‚öñÔ∏è Peso (kg)</div>
        <input class="input" type="number" step="1" name="peso_kg" placeholder="24000" style="padding-left:12px">
      </div>

      <div class="field">
        <div class="label">üßæ KM inicio</div>
        <input class="input" type="number" step="1" name="km_inicio" placeholder="Ej: 244200" style="padding-left:12px">
      </div>

      <div class="field">
        <div class="label">üìç Origen</div>
        <input class="input" name="origen" placeholder="Barcelona" required style="padding-left:12px">
      </div>

      <div class="field">
        <div class="label">üìç Destino</div>
        <input class="input" name="destino" placeholder="Vitoria" required style="padding-left:12px">
      </div>

      <div class="field">
        <div class="label">üßæ KM fin</div>
        <input class="input" type="number" step="1" name="km_fin" placeholder="Ej: 245000" required style="padding-left:12px">
      </div>

      <div class="field" style="grid-column: 1 / -1; display:flex; justify-content:flex-end">
        <button class="btn btn-primary" type="submit">Guardar viaje</button>
      </div>

    </form>
  </div>

  <div style="height:14px"></div>

  <div class="card card-pad">
    <div class="row" style="justify-content:space-between; align-items:center">
      <div class="h2">√öltimos viajes</div>
      <div class="tiny">M√°x. 200</div>
    </div>

    <div style="overflow:auto; margin-top:10px">
      <table style="width:100%; border-collapse:collapse; background:#fff">
        <thead>
          <tr>
            <th style="text-align:left; padding:10px; border-bottom:1px solid var(--border)">Fecha</th>
            <th style="text-align:left; padding:10px; border-bottom:1px solid var(--border)">Origen ‚Üí Destino</th>
            <th style="text-align:right; padding:10px; border-bottom:1px solid var(--border)">KM</th>
            <th style="text-align:right; padding:10px; border-bottom:1px solid var(--border)">Peso (kg)</th>
          </tr>
        </thead>
        <tbody>
          {% if rows and rows|length > 0 %}
            {% for r in rows %}
              <tr>
                <td style="padding:10px; border-bottom:1px solid var(--border)">{{ r.fecha }}</td>

                <td style="padding:10px; border-bottom:1px solid var(--border)">
                  <b>{{ r.origen }}</b> ‚Üí <b>{{ r.destino }}</b>
                </td>

                <td style="padding:10px; border-bottom:1px solid var(--border); text-align:right">
                  <b>{{ "%.0f"|format(r.km_total) }}</b>
                  <div class="tiny">{{ "%.0f"|format(r.km_inicio) }} ‚Üí {{ "%.0f"|format(r.km_fin) }}</div>
                </td>

                <td style="padding:10px; border-bottom:1px solid var(--border); text-align:right">
                  {{ "%.0f"|format(r.peso_kg) }}
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr><td colspan="4" class="muted" style="padding:12px">Sin viajes a√∫n.</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

{% endblock %}

