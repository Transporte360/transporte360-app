{% extends "layouts/base.html" %}
{% set title = "Login" %}

{% block content %}
<section id="viewLogin" class="login-wrap">
  <div class="login-card">

    <div class="login-head">
      <div class="login-brand">
        <div class="login-logo" aria-hidden="true">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
            <path d="M4 12l8-6 8 6" stroke="#E67E22" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7 12v8h10v-8" stroke="#fff" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="12" cy="12" r="2" fill="#E67E22"/>
          </svg>
        </div>
        <div class="col" style="gap:2px">
          <div class="h2" style="margin:0; font-size:22px">Transporte360</div>
          <div class="tiny">Sistema de GestiÃ³n de Flotas</div>
        </div>
      </div>

      <div class="sep"></div>

      <div class="col" style="gap:4px">
        <div class="h2">Iniciar SesiÃ³n</div>
        <div class="muted" style="font-size:13px">Ingrese sus credenciales para acceder al sistema</div>
      </div>
    </div>

    {% if error %}
      <div id="loginError" class="alert" style="margin-top:12px">
        <span>âš ï¸</span>
        <div>
          <div>{{ error }}</div>
          <div class="tiny" style="color:#7f1d1d; opacity:.85">Revise usuario y PIN</div>
        </div>
      </div>
    {% endif %}

    <form id="loginForm" method="post" action="/login" class="col" style="gap:12px; margin-top:14px">
      <div class="field">
        <div class="label">ğŸ‘¤ Usuario</div>
        <div style="position:relative">
          <svg class="icon-left" viewBox="0 0 24 24" fill="none">
            <path d="M20 21a8 8 0 10-16 0" stroke="rgba(30,58,95,.75)" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 13a4 4 0 100-8 4 4 0 000 8z" stroke="rgba(30,58,95,.75)" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <input class="input" id="username" name="username" placeholder="manager / driver1 / driver2" autocomplete="username" required />
        </div>
      </div>

      <div class="field">
        <div class="label">ğŸ”’ PIN (4 dÃ­gitos)</div>
        <div style="position:relative">
          <svg class="icon-left" viewBox="0 0 24 24" fill="none">
            <path d="M7 11V8a5 5 0 0110 0v3" stroke="rgba(30,58,95,.75)" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 11h10a2 2 0 012 2v6a2 2 0 01-2 2H7a2 2 0 01-2-2v-6a2 2 0 012-2z" stroke="rgba(30,58,95,.75)" stroke-width="2"/>
          </svg>
          <input class="input" id="pin" name="pin" type="password" placeholder="â€¢â€¢â€¢â€¢" inputmode="numeric" pattern="[0-9]{4}" maxlength="4" required />
          <button type="button" class="icon-btn" id="togglePin" aria-label="Mostrar/Ocultar PIN">ğŸ‘ï¸</button>
        </div>
        <div class="tiny">Ejemplo: manager=1234, driver1=5678, driver2=9012</div>
      </div>

      <button class="btn btn-primary" type="submit" style="position:relative; z-index:1">
        Entrar
        <span style="width:6px"></span>
        <span style="display:inline-flex; width:8px; height:8px; border-radius:999px; background:rgba(255,255,255,.65)"></span>
      </button>

      <div class="sep"></div>

      <div class="tiny">
        Â© 2026 Transporte360. Si hay problemas, contacte al administrador.
      </div>
    </form>
  </div>
</section>

<script>
  // Solo UI: mostrar/ocultar PIN
  const pin = document.getElementById("pin");
  const togglePin = document.getElementById("togglePin");
  togglePin?.addEventListener("click", () => {
    pin.type = (pin.type === "password") ? "text" : "password";
  });
</script>
{% endblock %}
